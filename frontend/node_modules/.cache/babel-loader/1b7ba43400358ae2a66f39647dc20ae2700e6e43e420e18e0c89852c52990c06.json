{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Reyden\\\\CommsApp\\\\frontend\\\\src\\\\components\\\\Voice.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from \"react\";\nimport \"./Voice.css\";\nimport { FaPhone, FaPhoneSlash, FaBackspace } from \"react-icons/fa\";\nimport { Device } from \"twilio-client\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst API_URL = process.env.REACT_APP_API_URL || \"http://localhost:5000\";\nconst Voice = () => {\n  _s();\n  const [phoneNumber, setPhoneNumber] = useState(\"\");\n  const [callActive, setCallActive] = useState(false);\n  const [call, setCall] = useState(null);\n  const [incomingCallVisible, setIncomingCallVisible] = useState(false);\n  const [incomingCall, setIncomingCall] = useState(null);\n  const [error, setError] = useState(null);\n  const [callDuration, setCallDuration] = useState(0);\n  const deviceRef = useRef(null);\n  const timerRef = useRef(null);\n  useEffect(() => {\n    const setupDevice = async () => {\n      try {\n        console.log(\"Fetching token...\");\n        const token = await fetchToken();\n        if (token) {\n          console.log(\"Token received. Setting up device...\");\n          const newDevice = new Device(token);\n          deviceRef.current = newDevice;\n          newDevice.on(\"ready\", () => {\n            console.log(\"Twilio Device Ready!\");\n          });\n          newDevice.on(\"error\", error => {\n            console.error(\"Twilio Device Error:\", error);\n            setError(\"Error setting up device.\");\n          });\n          newDevice.on(\"incoming\", incomingCall => {\n            console.log(\"Incoming Call:\", incomingCall);\n            setIncomingCallVisible(true);\n            setIncomingCall(incomingCall);\n          });\n          newDevice.on(\"disconnect\", () => {\n            console.log(\"Call disconnected.\");\n            setCallActive(false);\n            setCall(null);\n            clearInterval(timerRef.current); // Clean up timer\n            setCallDuration(0); // Reset call duration\n          });\n        }\n      } catch (error) {\n        console.error(\"Error setting up device:\", error);\n        //setError(\"Error initializing Twilio device.\");\n      }\n    };\n    setupDevice();\n    return () => {\n      if (deviceRef.current) {\n        console.log(\"Destroying device...\");\n        deviceRef.current.destroy(); // Clean up when component unmounts\n      }\n      clearInterval(timerRef.current); // Clean up timer on unmount\n    };\n  }, []);\n\n  // Fetch Twilio token from the backend\n  const fetchToken = async () => {\n    try {\n      console.log(\"Fetching token...\");\n      const response = await fetch(`${API_URL}/api/token`);\n      if (!response.ok) {\n        console.error(\"Error fetching token:\", response.statusText);\n        throw new Error(`Failed to fetch token: ${response.statusText}`);\n      }\n      const data = await response.json();\n      if (data.token) {\n        console.log(\"Token received:\", data.token);\n        return data.token;\n      } else {\n        console.error(\"Token is undefined:\", data);\n        throw new Error(\"Token is undefined\");\n      }\n    } catch (error) {\n      console.error(\"Error fetching token:\", error);\n      setError(\"Error fetching token from the backend.\");\n      throw error; // Re-throw to handle error\n    }\n  };\n\n  // Handle phone number digit input\n  const handleDigitClick = digit => {\n    setPhoneNumber(prev => prev + digit);\n  };\n\n  // Validate phone number format (E.164 format)\n  const validatePhoneNumber = number => {\n    const phoneRegex = /^\\+?[1-9]\\d{1,14}$/; // E.164 format validation\n    return phoneRegex.test(number);\n  };\n\n  // Handle initiating a call\n  const handleCall = async () => {\n    if (!phoneNumber) {\n      setError(\"Please enter a phone number.\");\n      return;\n    }\n\n    // Check if the phone number is valid and in the correct format\n    if (!validatePhoneNumber(phoneNumber)) {\n      setError(\"Invalid phone number format. Use E.164 format.\");\n      return;\n    }\n    try {\n      console.log(\"Initiating call to:\", phoneNumber);\n\n      // Make a request to the backend to initiate the call\n      const response = await fetch(`${API_URL}/make_call`, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify({\n          to: phoneNumber\n        })\n      });\n      const data = await response.json();\n      if (response.ok) {\n        console.log(\"Call initiated successfully!\", data);\n        setCallActive(true);\n        setCall(data.call); // Set call data to be used for hangup\n        setError(null); // Clear any errors\n        startCallTimer(); // Start timer for outgoing calls\n      } else {\n        setError(data.message || \"Failed to initiate call\");\n        console.error(\"Failed to initiate call:\", data.message);\n      }\n    } catch (error) {\n      console.error(\"Error initiating call:\", error);\n      setError(\"Failed to initiate call. Check if the number is verified.\");\n    }\n  };\n\n  // Handle hanging up the call\n  const handleHangup = () => {\n    console.log(\"Attempting to hang up the call...\");\n    if (call) {\n      console.log(\"Call object exists. Disconnecting...\");\n      call.disconnect(); // Disconnecting the active call\n      setCallActive(false);\n      setCall(null); // Reset the call object after disconnecting\n      clearInterval(timerRef.current); // Clean up timer\n      setCallDuration(0); // Reset call duration\n      setError(null); // Clear any errors\n      console.log(\"Call disconnected\");\n    } else {\n      console.error(\"No active call to hang up.\");\n      // Optionally, you can retry after a short delay if you suspect a race condition\n      setTimeout(() => handleHangup(), 500); // Retry after 500ms\n    }\n  };\n\n  // Accept incoming call\n  const acceptCall = async () => {\n    if (incomingCall) {\n      console.log(\"Accepting incoming call...\");\n      try {\n        const acceptedCall = await incomingCall.accept();\n        console.log(\"Call accepted!\", acceptedCall);\n        setCallActive(true);\n        setCall(acceptedCall); // Ensure this line updates the call state correctly\n        setIncomingCallVisible(false); // Hide the popup\n        setError(null); // Clear any errors\n      } catch (error) {\n        console.error(\"Error accepting call:\", error);\n        setError(\"Error accepting incoming call.\");\n      }\n    }\n  };\n\n  // Reject incoming call\n  const rejectCall = () => {\n    if (incomingCall) {\n      console.log(\"Rejecting incoming call...\");\n      incomingCall.reject();\n      setIncomingCallVisible(false); // Hide the popup\n    }\n  };\n\n  // Handle deleting one digit at a time\n  const handleDelete = () => {\n    setPhoneNumber(prev => prev.slice(0, -1)); // Removes one character from the end\n  };\n\n  // Function to start the call timer\n  const startCallTimer = () => {\n    timerRef.current = setInterval(() => {\n      setCallDuration(prevDuration => prevDuration + 1);\n    }, 1000); // Increment every second\n  };\n\n  // Helper function to format duration\n  const formatDuration = seconds => {\n    const hours = Math.floor(seconds / 3600);\n    const minutes = Math.floor(seconds % 3600 / 60);\n    const secondsRemaining = seconds % 60;\n    return `${hours.toString().padStart(2, \"0\")}:${minutes.toString().padStart(2, \"0\")}:${secondsRemaining.toString().padStart(2, \"0\")}`;\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"call-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"dialpad-container\",\n      children: [callActive && /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"call-duration\",\n        children: [\"Call Duration: \", formatDuration(callDuration)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 221,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"phone-number-display\",\n        children: phoneNumber\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 225,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"dialpad\",\n        children: [1, 2, 3, 4, 5, 6, 7, 8, 9, \"+\", 0, \"#\"].map(digit => /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"digit-button\",\n          onClick: () => handleDigitClick(digit.toString()),\n          children: digit\n        }, digit, false, {\n          fileName: _jsxFileName,\n          lineNumber: 228,\n          columnNumber: 13\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 226,\n        columnNumber: 9\n      }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"error-message\",\n        children: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 237,\n        columnNumber: 19\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"call-actions\",\n        children: callActive ? /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"hangup-button\",\n          onClick: handleHangup,\n          children: /*#__PURE__*/_jsxDEV(FaPhoneSlash, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 241,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 240,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"action-buttons\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"call-button\",\n            onClick: handleCall,\n            children: /*#__PURE__*/_jsxDEV(FaPhone, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 246,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 245,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"delete-button\",\n            onClick: handleDelete // Update to use handleDelete\n            ,\n            children: /*#__PURE__*/_jsxDEV(FaBackspace, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 252,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 248,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 244,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 238,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 219,\n      columnNumber: 7\n    }, this), incomingCallVisible && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"incoming-call-popup\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"Incoming Call\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 261,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"accept-button\",\n        onClick: acceptCall,\n        children: \"Accept\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 262,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"reject-button\",\n        onClick: rejectCall,\n        children: \"Reject\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 265,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 260,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 218,\n    columnNumber: 5\n  }, this);\n};\n_s(Voice, \"Vo7Fuk2IItKuuLW2XWS37Bt1gFI=\");\n_c = Voice;\nexport default Voice;\nvar _c;\n$RefreshReg$(_c, \"Voice\");","map":{"version":3,"names":["React","useState","useEffect","useRef","FaPhone","FaPhoneSlash","FaBackspace","Device","jsxDEV","_jsxDEV","API_URL","process","env","REACT_APP_API_URL","Voice","_s","phoneNumber","setPhoneNumber","callActive","setCallActive","call","setCall","incomingCallVisible","setIncomingCallVisible","incomingCall","setIncomingCall","error","setError","callDuration","setCallDuration","deviceRef","timerRef","setupDevice","console","log","token","fetchToken","newDevice","current","on","clearInterval","destroy","response","fetch","ok","statusText","Error","data","json","handleDigitClick","digit","prev","validatePhoneNumber","number","phoneRegex","test","handleCall","method","headers","body","JSON","stringify","to","startCallTimer","message","handleHangup","disconnect","setTimeout","acceptCall","acceptedCall","accept","rejectCall","reject","handleDelete","slice","setInterval","prevDuration","formatDuration","seconds","hours","Math","floor","minutes","secondsRemaining","toString","padStart","className","children","fileName","_jsxFileName","lineNumber","columnNumber","map","onClick","_c","$RefreshReg$"],"sources":["C:/Users/Reyden/CommsApp/frontend/src/components/Voice.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from \"react\";\r\nimport \"./Voice.css\";\r\nimport { FaPhone, FaPhoneSlash, FaBackspace } from \"react-icons/fa\";\r\nimport { Device } from \"twilio-client\";\r\n\r\nconst API_URL = process.env.REACT_APP_API_URL || \"http://localhost:5000\";\r\n\r\nconst Voice = () => {\r\n  const [phoneNumber, setPhoneNumber] = useState(\"\");\r\n  const [callActive, setCallActive] = useState(false);\r\n  const [call, setCall] = useState(null);\r\n  const [incomingCallVisible, setIncomingCallVisible] = useState(false);\r\n  const [incomingCall, setIncomingCall] = useState(null);\r\n  const [error, setError] = useState(null);\r\n  const [callDuration, setCallDuration] = useState(0);\r\n  const deviceRef = useRef(null);\r\n  const timerRef = useRef(null);\r\n\r\n  useEffect(() => {\r\n    const setupDevice = async () => {\r\n      try {\r\n        console.log(\"Fetching token...\");\r\n        const token = await fetchToken();\r\n        if (token) {\r\n          console.log(\"Token received. Setting up device...\");\r\n          const newDevice = new Device(token);\r\n          deviceRef.current = newDevice;\r\n\r\n          newDevice.on(\"ready\", () => {\r\n            console.log(\"Twilio Device Ready!\");\r\n          });\r\n\r\n          newDevice.on(\"error\", (error) => {\r\n            console.error(\"Twilio Device Error:\", error);\r\n            setError(\"Error setting up device.\");\r\n          });\r\n\r\n          newDevice.on(\"incoming\", (incomingCall) => {\r\n            console.log(\"Incoming Call:\", incomingCall);\r\n            setIncomingCallVisible(true);\r\n            setIncomingCall(incomingCall);\r\n          });\r\n\r\n          newDevice.on(\"disconnect\", () => {\r\n            console.log(\"Call disconnected.\");\r\n            setCallActive(false);\r\n            setCall(null);\r\n            clearInterval(timerRef.current); // Clean up timer\r\n            setCallDuration(0); // Reset call duration\r\n          });\r\n        }\r\n      } catch (error) {\r\n        console.error(\"Error setting up device:\", error);\r\n        //setError(\"Error initializing Twilio device.\");\r\n      }\r\n    };\r\n\r\n    setupDevice();\r\n\r\n    return () => {\r\n      if (deviceRef.current) {\r\n        console.log(\"Destroying device...\");\r\n        deviceRef.current.destroy(); // Clean up when component unmounts\r\n      }\r\n      clearInterval(timerRef.current); // Clean up timer on unmount\r\n    };\r\n  }, []);\r\n\r\n  // Fetch Twilio token from the backend\r\n  const fetchToken = async () => {\r\n    try {\r\n      console.log(\"Fetching token...\");\r\n      const response = await fetch(`${API_URL}/api/token`);\r\n      if (!response.ok) {\r\n        console.error(\"Error fetching token:\", response.statusText);\r\n        throw new Error(`Failed to fetch token: ${response.statusText}`);\r\n      }\r\n\r\n      const data = await response.json();\r\n      if (data.token) {\r\n        console.log(\"Token received:\", data.token);\r\n        return data.token;\r\n      } else {\r\n        console.error(\"Token is undefined:\", data);\r\n        throw new Error(\"Token is undefined\");\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error fetching token:\", error);\r\n      setError(\"Error fetching token from the backend.\");\r\n      throw error; // Re-throw to handle error\r\n    }\r\n  };\r\n\r\n  // Handle phone number digit input\r\n  const handleDigitClick = (digit) => {\r\n    setPhoneNumber((prev) => prev + digit);\r\n  };\r\n\r\n  // Validate phone number format (E.164 format)\r\n  const validatePhoneNumber = (number) => {\r\n    const phoneRegex = /^\\+?[1-9]\\d{1,14}$/; // E.164 format validation\r\n    return phoneRegex.test(number);\r\n  };\r\n\r\n  // Handle initiating a call\r\n  const handleCall = async () => {\r\n    if (!phoneNumber) {\r\n      setError(\"Please enter a phone number.\");\r\n      return;\r\n    }\r\n\r\n    // Check if the phone number is valid and in the correct format\r\n    if (!validatePhoneNumber(phoneNumber)) {\r\n      setError(\"Invalid phone number format. Use E.164 format.\");\r\n      return;\r\n    }\r\n\r\n    try {\r\n      console.log(\"Initiating call to:\", phoneNumber);\r\n\r\n      // Make a request to the backend to initiate the call\r\n      const response = await fetch(`${API_URL}/make_call`, {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify({ to: phoneNumber }),\r\n      });\r\n\r\n      const data = await response.json();\r\n\r\n      if (response.ok) {\r\n        console.log(\"Call initiated successfully!\", data);\r\n        setCallActive(true);\r\n        setCall(data.call); // Set call data to be used for hangup\r\n        setError(null); // Clear any errors\r\n        startCallTimer(); // Start timer for outgoing calls\r\n      } else {\r\n        setError(data.message || \"Failed to initiate call\");\r\n        console.error(\"Failed to initiate call:\", data.message);\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error initiating call:\", error);\r\n      setError(\"Failed to initiate call. Check if the number is verified.\");\r\n    }\r\n  };\r\n\r\n  // Handle hanging up the call\r\n  const handleHangup = () => {\r\n    console.log(\"Attempting to hang up the call...\");\r\n    if (call) {\r\n      console.log(\"Call object exists. Disconnecting...\");\r\n      call.disconnect(); // Disconnecting the active call\r\n      setCallActive(false);\r\n      setCall(null); // Reset the call object after disconnecting\r\n      clearInterval(timerRef.current); // Clean up timer\r\n      setCallDuration(0); // Reset call duration\r\n      setError(null); // Clear any errors\r\n      console.log(\"Call disconnected\");\r\n    } else {\r\n      console.error(\"No active call to hang up.\");\r\n      // Optionally, you can retry after a short delay if you suspect a race condition\r\n      setTimeout(() => handleHangup(), 500); // Retry after 500ms\r\n    }\r\n  };\r\n\r\n  // Accept incoming call\r\n  const acceptCall = async () => {\r\n    if (incomingCall) {\r\n      console.log(\"Accepting incoming call...\");\r\n      try {\r\n        const acceptedCall = await incomingCall.accept();\r\n        console.log(\"Call accepted!\", acceptedCall);\r\n        setCallActive(true);\r\n        setCall(acceptedCall); // Ensure this line updates the call state correctly\r\n        setIncomingCallVisible(false); // Hide the popup\r\n        setError(null); // Clear any errors\r\n      } catch (error) {\r\n        console.error(\"Error accepting call:\", error);\r\n        setError(\"Error accepting incoming call.\");\r\n      }\r\n    }\r\n  };\r\n\r\n  // Reject incoming call\r\n  const rejectCall = () => {\r\n    if (incomingCall) {\r\n      console.log(\"Rejecting incoming call...\");\r\n      incomingCall.reject();\r\n      setIncomingCallVisible(false); // Hide the popup\r\n    }\r\n  };\r\n\r\n  // Handle deleting one digit at a time\r\n  const handleDelete = () => {\r\n    setPhoneNumber((prev) => prev.slice(0, -1)); // Removes one character from the end\r\n  };\r\n\r\n  // Function to start the call timer\r\n  const startCallTimer = () => {\r\n    timerRef.current = setInterval(() => {\r\n      setCallDuration((prevDuration) => prevDuration + 1);\r\n    }, 1000); // Increment every second\r\n  };\r\n\r\n  // Helper function to format duration\r\n  const formatDuration = (seconds) => {\r\n    const hours = Math.floor(seconds / 3600);\r\n    const minutes = Math.floor((seconds % 3600) / 60);\r\n    const secondsRemaining = seconds % 60;\r\n\r\n    return `${hours.toString().padStart(2, \"0\")}:${minutes\r\n      .toString()\r\n      .padStart(2, \"0\")}:${secondsRemaining.toString().padStart(2, \"0\")}`;\r\n  };\r\n\r\n  return (\r\n    <div className=\"call-container\">\r\n      <div className=\"dialpad-container\">\r\n        {callActive && (\r\n          <p className=\"call-duration\">\r\n            Call Duration: {formatDuration(callDuration)}\r\n          </p>\r\n        )}\r\n        <div className=\"phone-number-display\">{phoneNumber}</div>\r\n        <div className=\"dialpad\">\r\n          {[1, 2, 3, 4, 5, 6, 7, 8, 9, \"+\", 0, \"#\"].map((digit) => (\r\n            <button\r\n              key={digit}\r\n              className=\"digit-button\"\r\n              onClick={() => handleDigitClick(digit.toString())}\r\n            >\r\n              {digit}\r\n            </button>\r\n          ))}\r\n        </div>\r\n        {error && <div className=\"error-message\">{error}</div>}\r\n        <div className=\"call-actions\">\r\n          {callActive ? (\r\n            <button className=\"hangup-button\" onClick={handleHangup}>\r\n              <FaPhoneSlash />\r\n            </button>\r\n          ) : (\r\n            <div className=\"action-buttons\">\r\n              <button className=\"call-button\" onClick={handleCall}>\r\n                <FaPhone />\r\n              </button>\r\n              <button\r\n                className=\"delete-button\"\r\n                onClick={handleDelete} // Update to use handleDelete\r\n              >\r\n                <FaBackspace />\r\n              </button>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      {incomingCallVisible && (\r\n        <div className=\"incoming-call-popup\">\r\n          <h2>Incoming Call</h2>\r\n          <button className=\"accept-button\" onClick={acceptCall}>\r\n            Accept\r\n          </button>\r\n          <button className=\"reject-button\" onClick={rejectCall}>\r\n            Reject\r\n          </button>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Voice;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}